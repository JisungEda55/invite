<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waze ë°°ë‹¬ ë°ëª¨ - ë¶€ì‚° ì„œë©´</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f1f3f5; }
        #map { height: 350px; width: 100%; border-radius: 0 0 2rem 2rem; }
        .waze-blue { background-color: #33CCFF; }
        .waze-shadow { box-shadow: 0 10px 25px -5px rgba(51, 204, 255, 0.3); }
        /* ë¼ì´ë” ë§í’ì„  ì• ë‹ˆë©”ì´ì…˜ */
        .rider-popup {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        /* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” ì œê±° */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const DeliveryApp = () => {
            // ìœ„ì¹˜: ë¶€ì‚° ì„œë©´
            const DEST = [35.158, 129.059]; // ë‚´ ìœ„ì¹˜ (ì„œë©´ì—­)
            const START = [35.150, 129.068]; // ê°€ê²Œ ìœ„ì¹˜ (ë²”ëƒ‡ê³¨ ì¸ê·¼)
            
            const [step, setStep] = useState(1);
            const [likes, setLikes] = useState(124);
            const [timeLeft, setTimeLeft] = useState(680); // ì´ˆ ë‹¨ìœ„
            const [isTipActive, setIsTipActive] = useState(false);
            const [riderMsg, setRiderMsg] = useState("ì•ˆì „í•˜ê²Œ ë°°ë‹¬ ì¤‘ì…ë‹ˆë‹¤!");
            
            const mapRef = useRef(null);
            const riderRef = useRef(null);

            useEffect(() => {
                if (!mapRef.current) {
                    // Waze ìŠ¤íƒ€ì¼ì˜ ë°ì€ ì§€ë„ë¥¼ ìœ„í•´ ë°°ê²½ìƒ‰ê³¼ í•„í„° ì¡°ì •
                    mapRef.current = L.map('map', { zoomControl: false }).setView(DEST, 15);
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png').addTo(mapRef.current);

                    // ëª©ì ì§€ (Waze ìŠ¤íƒ€ì¼ í•€)
                    const homeIcon = L.divIcon({
                        html: `<div class="relative w-10 h-10 flex items-center justify-center">
                                <div class="absolute inset-0 bg-white rounded-full shadow-lg border-4 border-blue-400"></div>
                                <span class="relative text-lg">ğŸ </span>
                               </div>`,
                        className: ''
                    });
                    L.marker(DEST, { icon: homeIcon }).addTo(mapRef.current);

                    // ë¼ì´ë” (Waze ìŠ¤íƒ€ì¼ ë¬´ë“œ)
                    const riderIcon = L.divIcon({
                        html: `<div class="rider-popup relative">
                                <div class="bg-black text-white text-[10px] px-2 py-1 rounded-full absolute -top-8 left-1/2 -translate-x-1/2 whitespace-nowrap">ë°°ë‹¬ì¤‘</div>
                                <div class="text-3xl">ğŸš™</div>
                               </div>`,
                        className: ''
                    });
                    riderRef.current = L.marker(START, { icon: riderIcon }).addTo(mapRef.current);
                }

                if (step === 1) {
                    let p = 0;
                    const interval = setInterval(() => {
                        p += 0.002;
                        if (p <= 1) {
                            const lat = START[0] + (DEST[0] - START[0]) * p;
                            const lng = START[1] + (DEST[1] - START[1]) * p;
                            riderRef.current.setLatLng([lat, lng]);
                        }
                    }, 1000);
                    return () => clearInterval(interval);
                }
            }, [step]);

            return (
                <div className="max-w-[480px] mx-auto bg-white min-h-screen relative overflow-hidden flex flex-col no-scrollbar">
                    {/* Waze í—¤ë” ìŠ¤íƒ€ì¼ */}
                    <div id="map" className="relative shadow-inner">
                        <div className="absolute top-6 left-4 right-4 z-[1000] flex justify-between items-start">
                            <button className="bg-white/90 backdrop-blur p-3 rounded-2xl shadow-xl">
                                <svg className="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="3" d="M15 19l-7-7 7-7"></path></svg>
                            </button>
                            <div className="bg-white/95 backdrop-blur px-6 py-3 rounded-3xl shadow-2xl flex items-center gap-3 border border-blue-50">
                                <div className="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                                <span className="font-black text-gray-800 text-sm tracking-tight uppercase">On Schedule</span>
                            </div>
                        </div>
                    </div>

                    {/* ë°°ë‹¬ ì •ë³´ ë©”ì¸ ì¹´ë“œ (ì˜¬ë¼ì˜¤ëŠ” ìŠ¤íƒ€ì¼) */}
                    <div className="flex-1 bg-white -mt-12 rounded-t-[3rem] relative z-[1001] px-8 pt-10 pb-20 shadow-[0_-20px_40px_rgba(0,0,0,0.05)]">
                        <div className="flex justify-between items-end mb-8">
                            <div>
                                <div className="flex items-center gap-2 mb-2">
                                    <span className="waze-blue text-white text-[10px] font-black px-2 py-1 rounded-md uppercase tracking-widest">Express</span>
                                    <span className="text-gray-400 font-bold text-[11px]">ì„œë©´ì—­ 7ë²ˆ ì¶œêµ¬ ë°©ë©´</span>
                                </div>
                                <h2 className="text-4xl font-black text-gray-900 leading-tight">
                                    {Math.floor(timeLeft / 60)}<span className="text-xl ml-1">min</span>
                                </h2>
                                <p className="text-gray-500 font-semibold mt-1">ê³§ í˜„ê´€ ì•ì— ë„ì°©í•©ë‹ˆë‹¤!</p>
                            </div>
                            <button 
                                onClick={() => setLikes(l => l + 1)}
                                className="flex flex-col items-center group active:scale-95 transition"
                            >
                                <div className="w-14 h-14 bg-pink-50 rounded-2xl flex items-center justify-center text-2xl group-hover:bg-pink-100 transition-colors">ğŸ‘</div>
                                <span className="text-[10px] font-black mt-2 text-gray-400 uppercase tracking-tighter">{likes} Cheer up</span>
                            </button>
                        </div>

                        {/* ë¼ì´ë”ì™€ì˜ ì‹¤ì‹œê°„ ì†Œí†µ ê¸°ëŠ¥ ì¶”ê°€ */}
                        <div className="bg-gray-50 rounded-3xl p-4 mb-8 flex items-center gap-4 border border-gray-100">
                            <div className="w-12 h-12 bg-blue-100 rounded-full overflow-hidden border-2 border-white shadow-sm flex items-center justify-center text-xl">ğŸ¤´</div>
                            <div className="flex-1">
                                <p className="text-[11px] font-black text-blue-500 uppercase tracking-wider mb-0.5">Rider Message</p>
                                <input 
                                    className="bg-transparent border-none text-sm font-bold text-gray-800 focus:outline-none w-full"
                                    value={riderMsg}
                                    onChange={(e) => setRiderMsg(e.target.value)}
                                />
                            </div>
                            <button className="bg-white p-2 rounded-xl shadow-sm"><svg className="w-5 h-5 text-blue-500" fill="currentColor" viewBox="0 0 20 20"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"></path></svg></button>
                        </div>

                        {/* íŒ ì „ë‹¬ ë²„íŠ¼ (ê¸°ëŠ¥ ì¶”ê°€) */}
                        <div className="flex gap-4 mb-8 overflow-x-auto no-scrollbar pb-2">
                            {['ğŸ¥¤ ê°ì‚¬ ìŒë£Œ', 'ğŸ° ë‹¬ì½¤í•œ ê°„ì‹', 'ğŸ  ë²¨ ì•ˆëˆ„ë¥´ê¸°', 'ğŸš² ì•ˆì „ìš´ì „'].map(item => (
                                <button key={item} className="whitespace-nowrap bg-white border-2 border-gray-100 px-4 py-2.5 rounded-2xl text-xs font-bold text-gray-600 hover:border-blue-300 hover:text-blue-500 transition-all active:scale-95 shadow-sm">
                                    {item}
                                </button>
                            ))}
                        </div>

                        {/* ì£¼ë¬¸ ìš”ì•½ ì•„ì½”ë””ì–¸ ëŠë‚Œ */}
                        <div className="space-y-4">
                            <div className="flex justify-between items-center">
                                <h3 className="font-black text-gray-900">ì£¼ë¬¸ ë‚´ì—­</h3>
                                <span className="text-xs font-bold text-blue-500">ìƒì„¸ë³´ê¸°</span>
                            </div>
                            <div className="bg-blue-50/50 rounded-3xl p-6 border border-blue-100/50">
                                <div className="flex justify-between mb-4">
                                    <span className="font-bold text-gray-700">ê³µì°¨ ë§ê³  ìŠ¤ë¬´ë”” J x 1</span>
                                    <span className="font-black text-gray-900">7,200ì›</span>
                                </div>
                                <div className="flex justify-between text-sm">
                                    <span className="font-bold text-gray-400">Total Discount</span>
                                    <span className="font-bold text-pink-500">-2,400ì›</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* í•˜ë‹¨ í”Œë¡œíŒ… ì•¡ì…˜ ë°” */}
                    <div className="fixed bottom-0 left-0 right-0 max-w-[480px] mx-auto p-6 bg-white/80 backdrop-blur-xl border-t border-gray-100 z-[1002] flex gap-4">
                        <button className="flex-1 py-5 waze-blue text-white rounded-3xl font-black text-sm waze-shadow active:scale-95 transition-transform uppercase tracking-widest">
                            Order Support
                        </button>
                        <button className="w-20 py-5 bg-gray-100 text-gray-500 rounded-3xl font-black text-sm flex items-center justify-center active:scale-95 transition-transform">
                            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2.5" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg>
                        </button>
                    </div>

                    {/* ë°ëª¨ìš© ì œì–´ íŒ¨ë„ (ìˆ˜ì •) */}
                    <div className="fixed top-32 right-4 z-[2000] flex flex-col gap-3">
                        <div className="bg-black/90 text-white p-2 rounded-2xl flex flex-col gap-2 shadow-2xl scale-75 origin-right">
                             <button onClick={() => setStep(0)} className={`p-2 rounded-xl text-[10px] font-bold ${step===0?'bg-white text-black':''}`}>PREPARING</button>
                             <button onClick={() => setStep(1)} className={`p-2 rounded-xl text-[10px] font-bold ${step===1?'bg-white text-black':''}`}>DRIVING</button>
                             <button onClick={() => setStep(2)} className={`p-2 rounded-xl text-[10px] font-bold ${step===2?'bg-white text-black':''}`}>ARRIVED</button>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<DeliveryApp />);
    </script>
</body>
</html>
